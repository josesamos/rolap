<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Data in multidimensional systems is obtained from operational
    systems and is transformed to adapt it to the new structure.
    Frequently, the operations to be performed aim to transform a flat
    table into a ROLAP (Relational On-Line Analytical Processing) star
    database. The main objective of the package is to allow the definition
    of these transformations easily. The implementation of the multidimensional 
    database obtained can be exported to work with multidimensional analysis 
    tools on spreadsheets or relational databases.">
<title>Obtaining Star Databases from Flat Tables • rolap</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Obtaining Star Databases from Flat Tables">
<meta property="og:description" content="Data in multidimensional systems is obtained from operational
    systems and is transformed to adapt it to the new structure.
    Frequently, the operations to be performed aim to transform a flat
    table into a ROLAP (Relational On-Line Analytical Processing) star
    database. The main objective of the package is to allow the definition
    of these transformations easily. The implementation of the multidimensional 
    database obtained can be exported to work with multidimensional analysis 
    tools on spreadsheets or relational databases.">
<meta property="og:image" content="https://josesamos.github.io/rolap/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">rolap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/rolap.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/josesamos/rolap/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="rolap-">rolap 
<a class="anchor" aria-label="anchor" href="#rolap-"></a>
</h1>
</div>
<!-- badges: start -->

<!-- [![Codecov test coverage](https://codecov.io/gh/josesamos/rolap/branch/master/graph/badge.svg)](https://app.codecov.io/gh/josesamos/rolap?branch=master) -->
<p>The aim of the <em>multidimensional data model</em> is organize data for supporting data analysis. Data in multidimensional systems is obtained from operational systems and is transformed to adapt it to the new structure.</p>
<p>Transformations can be carried out using professional ETL (<em>Extract, Transform and Load</em>) tools. Recently, tools aimed at end users have emerged, which are also aimed at performing transformation operations. All these tools are very useful to carry out the transformation process, they provide a development environment to define the transformation operations in a general way.</p>
<p>Frequently, the operations to be performed aim to transform a flat table (with data that comes from operational systems) into a ROLAP (<em>Relational On-Line Analytical Processing</em>) star database, made up of fact and dimension tables, which implements a multidimensional system. With the tools mentioned above, this transformation can be carried out, but it requires a lot of work. We are not aware of any tools with operations designed to specifically support this transformation process.</p>
<p>The goal of <code>rolap</code> is to define transformations that allow you to easily obtain ROLAP star databases, composed by fact and dimension tables, from flat tables and to be able to export them in various formats to be used by OLAP query tools.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of <code>rolap</code> from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rolap"</span><span class="op">)</span></span></code></pre></div>
<p>And the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"josesamos/rolap"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>To illustrate how the package works we will use a small part of the <a href="https://catalog.data.gov/dataset/deaths-in-122-u-s-cities-1962-2016-122-cities-mortality-reporting-system" class="external-link">Deaths in 122 U.S. cities - 1962-2016. 122 Cities Mortality Reporting System</a> data set in the form of a flat table, available in the package in the <code>ft_num</code> variable, shown below.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="2%">
<col width="7%">
<col width="3%">
<col width="2%">
<col width="5%">
<col width="13%">
<col width="5%">
<col width="12%">
<col width="13%">
<col width="5%">
<col width="13%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">Year</th>
<th align="center">WEEK</th>
<th align="center">Week Ending Date</th>
<th align="center">REGION</th>
<th align="center">State</th>
<th align="center">City</th>
<th align="center">Pneumonia and Influenza Deaths</th>
<th align="center">All Deaths</th>
<th align="center">&lt;1 year (all cause deaths)</th>
<th align="center">1-24 years (all cause deaths)</th>
<th align="center">25-44 years</th>
<th align="center">45-64 years (all cause deaths)</th>
<th align="center">65+ years (all cause deaths)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1962</td>
<td align="center">2</td>
<td align="center">01/13/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">11</td>
<td align="center">270</td>
<td align="center">14</td>
<td align="center">8</td>
<td align="center">11</td>
<td align="center">70</td>
<td align="center">167</td>
</tr>
<tr class="even">
<td align="center">1962</td>
<td align="center">4</td>
<td align="center">01/27/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">12</td>
<td align="center">285</td>
<td align="center">22</td>
<td align="center">7</td>
<td align="center">8</td>
<td align="center">73</td>
<td align="center">175</td>
</tr>
<tr class="odd">
<td align="center">1963</td>
<td align="center">4</td>
<td align="center">01/26/1963</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">10</td>
<td align="center">276</td>
<td align="center">11</td>
<td align="center">14</td>
<td align="center">17</td>
<td align="center">67</td>
<td align="center">167</td>
</tr>
<tr class="even">
<td align="center">1964</td>
<td align="center">3</td>
<td align="center">01/18/1964</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">13</td>
<td align="center">325</td>
<td align="center">17</td>
<td align="center">7</td>
<td align="center">24</td>
<td align="center">90</td>
<td align="center">187</td>
</tr>
<tr class="odd">
<td align="center">1964</td>
<td align="center">6</td>
<td align="center">02/08/1964</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">9</td>
<td align="center">244</td>
<td align="center">13</td>
<td align="center">9</td>
<td align="center">14</td>
<td align="center">61</td>
<td align="center">147</td>
</tr>
<tr class="even">
<td align="center">1962</td>
<td align="center">3</td>
<td align="center">01/20/1962</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
<td align="center">2</td>
<td align="center">40</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">10</td>
<td align="center">21</td>
</tr>
<tr class="odd">
<td align="center">1962</td>
<td align="center">5</td>
<td align="center">02/03/1962</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
<td align="center">5</td>
<td align="center">46</td>
<td align="center">6</td>
<td align="center">0</td>
<td align="center">3</td>
<td align="center">15</td>
<td align="center">22</td>
</tr>
<tr class="even">
<td align="center">1962</td>
<td align="center">8</td>
<td align="center">02/24/1962</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
<td align="center">2</td>
<td align="center">45</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">16</td>
<td align="center">25</td>
</tr>
<tr class="odd">
<td align="center">1963</td>
<td align="center">4</td>
<td align="center">01/26/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
<td align="center">2</td>
<td align="center">46</td>
<td align="center">4</td>
<td align="center">0</td>
<td align="center">3</td>
<td align="center">10</td>
<td align="center">29</td>
</tr>
<tr class="even">
<td align="center">1964</td>
<td align="center">5</td>
<td align="center">02/01/1964</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
<td align="center">8</td>
<td align="center">45</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">11</td>
<td align="center">28</td>
</tr>
<tr class="odd">
<td align="center">1962</td>
<td align="center">9</td>
<td align="center">03/03/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">4</td>
<td align="center">39</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">7</td>
<td align="center">29</td>
</tr>
<tr class="even">
<td align="center">1964</td>
<td align="center">2</td>
<td align="center">01/11/1964</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">7</td>
<td align="center">31</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">9</td>
<td align="center">19</td>
</tr>
<tr class="odd">
<td align="center">1964</td>
<td align="center">5</td>
<td align="center">02/01/1964</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">6</td>
<td align="center">27</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">8</td>
<td align="center">17</td>
</tr>
<tr class="even">
<td align="center">1964</td>
<td align="center">9</td>
<td align="center">02/29/1964</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">0</td>
<td align="center">26</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">8</td>
<td align="center">16</td>
</tr>
<tr class="odd">
<td align="center">1962</td>
<td align="center">4</td>
<td align="center">01/27/1962</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">1</td>
<td align="center">47</td>
<td align="center">7</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">14</td>
<td align="center">25</td>
</tr>
<tr class="even">
<td align="center">1962</td>
<td align="center">7</td>
<td align="center">02/17/1962</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">4</td>
<td align="center">57</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">21</td>
<td align="center">29</td>
</tr>
<tr class="odd">
<td align="center">1963</td>
<td align="center">3</td>
<td align="center">01/19/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">2</td>
<td align="center">66</td>
<td align="center">7</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">18</td>
<td align="center">36</td>
</tr>
<tr class="even">
<td align="center">1963</td>
<td align="center">7</td>
<td align="center">02/16/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">4</td>
<td align="center">77</td>
<td align="center">6</td>
<td align="center">1</td>
<td align="center">7</td>
<td align="center">19</td>
<td align="center">44</td>
</tr>
<tr class="odd">
<td align="center">1963</td>
<td align="center">8</td>
<td align="center">02/23/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">6</td>
<td align="center">49</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">14</td>
<td align="center">27</td>
</tr>
<tr class="even">
<td align="center">1964</td>
<td align="center">2</td>
<td align="center">01/11/1964</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">3</td>
<td align="center">53</td>
<td align="center">7</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">16</td>
<td align="center">28</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="star-database-definition">Star database definition<a class="anchor" aria-label="anchor" href="#star-database-definition"></a>
</h3>
<p>The transformation to obtain a star database from the flat table using <code>rolap</code> package is as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josesamos.github.io/rolap/">rolap</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">where</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dimension_schema.html">dimension_schema</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Where"</span>,</span>
<span>                          attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REGION"</span>,</span>
<span>                                         <span class="st">"State"</span>,</span>
<span>                                         <span class="st">"City"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/star_schema.html">star_schema</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_facts.html">define_facts</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"MRS Cause"</span>,</span>
<span>               measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pneumonia and Influenza Deaths"</span>,</span>
<span>                            <span class="st">"All Deaths"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_dimension.html">define_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"When"</span>,</span>
<span>                   attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_dimension.html">define_dimension</a></span><span class="op">(</span><span class="va">where</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/star_database.html">star_database</a></span><span class="op">(</span><span class="va">s</span>, <span class="va">ft_num</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/snake_case.html">snake_case</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The dimension and fact schemas can be defined as variables (<code>where</code>) to be reused or directly in the star schema definition. To make it easier to work in a database environment we transform the table field names to snake case.</p>
<p>With this same goal they can be exported as a tibble list.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ls</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/as_tibble_list.html">as_tibble_list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The tables of dimensions and facts of the obtained star database are shown below.</p>
<table class="table">
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1962</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1963</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1964</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">where_key</th>
<th align="center">region</th>
<th align="center">state</th>
<th align="center">city</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<colgroup>
<col width="13%">
<col width="14%">
<col width="42%">
<col width="15%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">where_key</th>
<th align="center">pneumonia_and_influenza_deaths</th>
<th align="center">all_deaths</th>
<th align="center">nrow_agg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">9</td>
<td align="center">131</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">104</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">3</td>
<td align="center">23</td>
<td align="center">555</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">39</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">46</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">12</td>
<td align="center">192</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">3</td>
<td align="center">10</td>
<td align="center">276</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">1</td>
<td align="center">8</td>
<td align="center">45</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">53</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">3</td>
<td align="center">22</td>
<td align="center">569</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">4</td>
<td align="center">13</td>
<td align="center">84</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="constellation-definition">Constellation definition<a class="anchor" aria-label="anchor" href="#constellation-definition"></a>
</h3>
<p>We can work with several star databases to form a constellation. To show an example of how data is integrated into dimensions, let’s filter the initial data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ft1</span> <span class="op">&lt;-</span> <span class="va">ft_num</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&gt;</span> <span class="st">"1962"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">City</span> <span class="op">==</span> <span class="st">"Boston"</span> <span class="op">|</span> <span class="va">City</span> <span class="op">==</span> <span class="st">"Bridgeport"</span><span class="op">)</span></span></code></pre></div>
<p>The flat table obtained is shown below.</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="2%">
<col width="2%">
<col width="7%">
<col width="3%">
<col width="2%">
<col width="5%">
<col width="13%">
<col width="5%">
<col width="12%">
<col width="13%">
<col width="5%">
<col width="13%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="center">Year</th>
<th align="center">WEEK</th>
<th align="center">Week Ending Date</th>
<th align="center">REGION</th>
<th align="center">State</th>
<th align="center">City</th>
<th align="center">Pneumonia and Influenza Deaths</th>
<th align="center">All Deaths</th>
<th align="center">&lt;1 year (all cause deaths)</th>
<th align="center">1-24 years (all cause deaths)</th>
<th align="center">25-44 years</th>
<th align="center">45-64 years (all cause deaths)</th>
<th align="center">65+ years (all cause deaths)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1963</td>
<td align="center">4</td>
<td align="center">01/26/1963</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">10</td>
<td align="center">276</td>
<td align="center">11</td>
<td align="center">14</td>
<td align="center">17</td>
<td align="center">67</td>
<td align="center">167</td>
</tr>
<tr class="even">
<td align="center">1964</td>
<td align="center">3</td>
<td align="center">01/18/1964</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">13</td>
<td align="center">325</td>
<td align="center">17</td>
<td align="center">7</td>
<td align="center">24</td>
<td align="center">90</td>
<td align="center">187</td>
</tr>
<tr class="odd">
<td align="center">1964</td>
<td align="center">6</td>
<td align="center">02/08/1964</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
<td align="center">9</td>
<td align="center">244</td>
<td align="center">13</td>
<td align="center">9</td>
<td align="center">14</td>
<td align="center">61</td>
<td align="center">147</td>
</tr>
<tr class="even">
<td align="center">1963</td>
<td align="center">4</td>
<td align="center">01/26/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
<td align="center">2</td>
<td align="center">46</td>
<td align="center">4</td>
<td align="center">0</td>
<td align="center">3</td>
<td align="center">10</td>
<td align="center">29</td>
</tr>
<tr class="odd">
<td align="center">1964</td>
<td align="center">5</td>
<td align="center">02/01/1964</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
<td align="center">8</td>
<td align="center">45</td>
<td align="center">3</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">11</td>
<td align="center">28</td>
</tr>
</tbody>
</table>
<p>Additionally, we transform the dataset to be tidy data and filter it.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ft2</span> <span class="op">&lt;-</span> <span class="va">ft_num</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">`Pneumonia and Influenza Deaths`</span>, <span class="op">-</span><span class="va">`All Deaths`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"All Deaths"</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`All Deaths` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">`All Deaths`</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Age <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span><span class="va">Age</span>, <span class="st">" \\(all cause deaths\\)"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Year</span> <span class="op">&lt;</span> <span class="st">"1964"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">City</span> <span class="op">!=</span> <span class="st">"Boston"</span> <span class="op">&amp;</span> <span class="va">City</span> <span class="op">!=</span> <span class="st">"Bridgeport"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">WEEK</span> <span class="op">&gt;=</span> <span class="st">"8"</span><span class="op">)</span></span></code></pre></div>
<p>In this case, the data set is adequate to treat the data by age. The tidy flat table obtained is shown below.</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="7%">
<col width="22%">
<col width="9%">
<col width="8%">
<col width="13%">
<col width="16%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="center">Year</th>
<th align="center">WEEK</th>
<th align="center">Week Ending Date</th>
<th align="center">REGION</th>
<th align="center">State</th>
<th align="center">City</th>
<th align="center">Age</th>
<th align="center">All Deaths</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1962</td>
<td align="center">9</td>
<td align="center">03/03/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">&lt;1 year</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">1963</td>
<td align="center">8</td>
<td align="center">02/23/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">&lt;1 year</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">1962</td>
<td align="center">9</td>
<td align="center">03/03/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">1-24 years</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1963</td>
<td align="center">8</td>
<td align="center">02/23/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">1-24 years</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">1962</td>
<td align="center">9</td>
<td align="center">03/03/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">25-44 years</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">1963</td>
<td align="center">8</td>
<td align="center">02/23/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">25-44 years</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">1962</td>
<td align="center">9</td>
<td align="center">03/03/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">45-64 years</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">1963</td>
<td align="center">8</td>
<td align="center">02/23/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">45-64 years</td>
<td align="center">14</td>
</tr>
<tr class="odd">
<td align="center">1962</td>
<td align="center">9</td>
<td align="center">03/03/1962</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
<td align="center">65+ years</td>
<td align="center">29</td>
</tr>
<tr class="even">
<td align="center">1963</td>
<td align="center">8</td>
<td align="center">02/23/1963</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
<td align="center">65+ years</td>
<td align="center">27</td>
</tr>
</tbody>
</table>
<p>We define the star databases, one with the data relative to the causes and the other with the age data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">when</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dimension_schema.html">dimension_schema</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"When"</span>,</span>
<span>                         attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">where</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/dimension_schema.html">dimension_schema</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Where"</span>,</span>
<span>                          attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REGION"</span>,</span>
<span>                                         <span class="st">"State"</span>,</span>
<span>                                         <span class="st">"City"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/star_schema.html">star_schema</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_facts.html">define_facts</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"MRS Cause"</span>,</span>
<span>               measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pneumonia and Influenza Deaths"</span>,</span>
<span>                            <span class="st">"All Deaths"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_dimension.html">define_dimension</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_dimension.html">define_dimension</a></span><span class="op">(</span><span class="va">where</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/star_database.html">star_database</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">ft1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/snake_case.html">snake_case</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/star_schema.html">star_schema</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_facts.html">define_facts</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"MRS Age"</span>,</span>
<span>               measures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All Deaths"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_dimension.html">define_dimension</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_dimension.html">define_dimension</a></span><span class="op">(</span><span class="va">where</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/define_dimension.html">define_dimension</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Who"</span>,</span>
<span>                         attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/star_database.html">star_database</a></span><span class="op">(</span><span class="va">s2</span>, <span class="va">ft2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/snake_case.html">snake_case</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The tables of dimensions and facts of the new <code>db1</code> star database focused on the causes are shown below.</p>
<table class="table">
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1963</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1964</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">where_key</th>
<th align="center">region</th>
<th align="center">state</th>
<th align="center">city</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<colgroup>
<col width="13%">
<col width="14%">
<col width="42%">
<col width="15%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">where_key</th>
<th align="center">pneumonia_and_influenza_deaths</th>
<th align="center">all_deaths</th>
<th align="center">nrow_agg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">46</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">10</td>
<td align="center">276</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">8</td>
<td align="center">45</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">22</td>
<td align="center">569</td>
<td align="center">2</td>
</tr>
</tbody>
</table>
<p>Below are the tables of the star database with the age data, the <code>db2</code> database.</p>
<table class="table">
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1962</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1963</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">where_key</th>
<th align="center">region</th>
<th align="center">state</th>
<th align="center">city</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">who_key</th>
<th align="center">age</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1-24 years</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">25-44 years</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">45-64 years</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">65+ years</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">&lt;1 year</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">where_key</th>
<th align="center">who_key</th>
<th align="center">all_deaths</th>
<th align="center">nrow_agg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">7</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">4</td>
<td align="center">29</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">14</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">27</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>As we have filtered the data, it can be seen that the dimension tables only contain the necessary data for each star database but, for common dimensions, they share the same structure.</p>
<p>Next we define a constellation formed by the two star databases.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/constellation.html">constellation</a></span><span class="op">(</span><span class="st">"MRS"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">db1</span>, <span class="va">db2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Constellation tables can also be exported as a tibble list.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lc</span> <span class="op">&lt;-</span> <span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/as_tibble_list.html">as_tibble_list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Below are the tables of the constellation’s star databases. The instances of the dimensions have been integrated so that the tables are common to both databases.</p>
<table class="table">
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1962</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1963</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1964</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">where_key</th>
<th align="center">region</th>
<th align="center">state</th>
<th align="center">city</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Bridgeport</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">CT</td>
<td align="center">Hartford</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Boston</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">1</td>
<td align="center">MA</td>
<td align="center">Cambridge</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">who_key</th>
<th align="center">age</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1-24 years</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">25-44 years</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">45-64 years</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">65+ years</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">&lt;1 year</td>
</tr>
</tbody>
</table>
<table style="width:100%;" class="table">
<colgroup>
<col width="13%">
<col width="14%">
<col width="42%">
<col width="15%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">where_key</th>
<th align="center">pneumonia_and_influenza_deaths</th>
<th align="center">all_deaths</th>
<th align="center">nrow_agg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">46</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">3</td>
<td align="center">10</td>
<td align="center">276</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1</td>
<td align="center">8</td>
<td align="center">45</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">3</td>
<td align="center">22</td>
<td align="center">569</td>
<td align="center">2</td>
</tr>
</tbody>
</table>
<table class="table">
<thead><tr class="header">
<th align="center">when_key</th>
<th align="center">where_key</th>
<th align="center">who_key</th>
<th align="center">all_deaths</th>
<th align="center">nrow_agg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">3</td>
<td align="center">7</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">29</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">4</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">3</td>
<td align="center">14</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">4</td>
<td align="center">27</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2</td>
<td align="center">5</td>
<td align="center">3</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>These tables can be directly exported in the format required by the OLAP query tool that we are going to use.</p>
</div>
<div class="section level3">
<h3 id="exportation-as-a-dm-object">Exportation as a <code>dm</code> object<a class="anchor" aria-label="anchor" href="#exportation-as-a-dm-object"></a>
</h3>
<p>Star databases and constellations can be directly exported as objects of class <a href="https://cran.r-project.org/package=dm" class="external-link">dm</a>, as shown below.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># star database</span></span>
<span><span class="va">db_dm</span> <span class="op">&lt;-</span> <span class="va">db</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/as_dm_class.html">as_dm_class</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">db_dm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dm"</span></span>
<span><span class="va">db_dm</span></span>
<span><span class="co">#&gt; ── Metadata ────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Tables: `when`, `where`, `mrs_cause`</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; Primary keys: 3</span></span>
<span><span class="co">#&gt; Foreign keys: 2</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># constellation</span></span>
<span><span class="va">ct_dm</span> <span class="op">&lt;-</span> <span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="reference/as_dm_class.html">as_dm_class</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ct_dm</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dm"</span></span>
<span><span class="va">ct_dm</span></span>
<span><span class="co">#&gt; ── Metadata ────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Tables: `when`, `where`, `who`, `mrs_cause`, `mrs_age`</span></span>
<span><span class="co">#&gt; Columns: 18</span></span>
<span><span class="co">#&gt; Primary keys: 5</span></span>
<span><span class="co">#&gt; Foreign keys: 5</span></span></code></pre></div>
<p>For example, the <code>dm</code> class object can be used to represent the tables or to store them in any RDBMS.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/josesamos/rolap/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/josesamos/rolap/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rolap</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jose Samos <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0002-4457-3439" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/josesamos/rolap/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/josesamos/rolap/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jose Samos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

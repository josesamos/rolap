<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rolap">
<title>Integration of dimension instances • rolap</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Integration of dimension instances">
<meta property="og:description" content="rolap">
<meta property="og:image" content="https://josesamos.github.io/rolap/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rolap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/rolap.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v05-flat-table-op.html">Obtaining and transforming flat tables</a>
    <a class="dropdown-item" href="../articles/v10-rpd.html">Definition of role-playing and role dimensions</a>
    <a class="dropdown-item" href="../articles/v20-rdbms-dm.html">Star databases and RDBMS through the dm and rolap packages</a>
    <a class="dropdown-item" href="../articles/v30-dim-instances.html">Integration of dimension instances</a>
    <a class="dropdown-item" href="../articles/v40-refresh.html">Incremental refresh of star databases</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/josesamos/rolap/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Integration of dimension instances</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/josesamos/rolap/blob/HEAD/vignettes/v30-dim-instances.Rmd" class="external-link"><code>vignettes/v30-dim-instances.Rmd</code></a></small>
      <div class="d-none name"><code>v30-dim-instances.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>It is generally recommended to perform data cleansing as close as
possible to the original data sources. Sometimes, the need to perform
data cleaning operations is detected when the multidimensional system is
already implemented, either because it hasn’t been detected in the data
sources or because it comes from multiple data sources. For example, we
can integrate several stars with common dimensions in a constellation
and, when conforming the dimensions, we observe that there are instances
that are actually the same and should be merged. For these cases, the
functions described in this document have been developed.</p>
<p>The document is structured as follows: First, we show examples of
functions that allow us to explore the instances of the dimensions; the
following shows how to modify instances of dimensions in a star database
for several attributes or for a single attribute; the next section
explains how the integration of instance modification operations is done
when we define a constellation; finally, we end with conclusions.</p>
</div>
<div class="section level2">
<h2 id="exploration-of-dimensions">Exploration of dimensions<a class="anchor" aria-label="anchor" href="#exploration-of-dimensions"></a>
</h2>
<p>To show by example the available operations, we are going to use the
multidimensional designs developed in the vignette titled <em>Star
databases and RDBMS through the <code>dm</code> and <code>rolap</code>
packages</em>, <code><a href="../articles/v20-rdbms-dm.html">vignette("v20-rdbms-dm")</a></code>, which are
available as a <code>star_database</code> objects
(<code>db_summary</code> and <code>db_finest</code>).</p>
<div class="section level3">
<h3 id="consult-tables-and-dimensions">Consult tables and dimensions<a class="anchor" aria-label="anchor" href="#consult-tables-and-dimensions"></a>
</h3>
<p>We will start working on one of the star databases,
<code>db_summary</code>. As shown below, we can get the names of the
available tables and, exporting them as a list of <code>tibble</code>
objects, we can see their number of instances.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://josesamos.github.io/rolap/">rolap</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">db_summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "star_database"</span></span>
<span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="va">db_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_table_names.html">get_table_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_tl</span> <span class="op">&lt;-</span> <span class="va">db_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_tibble_list.html">as_tibble_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">names</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"name: %s, %d rows\n"</span>, <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">db_tl</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; name: transaction_summary, 777 rows</span></span>
<span><span class="co">#&gt; name: what, 27 rows</span></span>
<span><span class="co">#&gt; name: when, 84 rows</span></span>
<span><span class="co">#&gt; name: when_paid, 84 rows</span></span>
<span><span class="co">#&gt; name: where_chain, 33 rows</span></span>
<span><span class="co">#&gt; name: who_segment, 6 rows</span></span></code></pre></div>
<p>If instead of all the tables, we want to focus on the dimensions, we
can get their names using the following function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_dimension_names.html">get_dimension_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "what"        "when"        "when_paid"   "where_chain" "who_segment"</span></span></code></pre></div>
<p>Although the design includes all of the above dimensions, we have
several dimensions that are role-playing and role dimensions, as shown
below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_role_playing_dimension_names.html">get_role_playing_dimension_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $rpd_1</span></span>
<span><span class="co">#&gt; [1] "when"      "when_paid"</span></span></code></pre></div>
<p>This means that these dimensions are considered to be represented by
a single table.</p>
</div>
<div class="section level3">
<h3 id="detect-similar-attribute-values-in-dimensions">Detect similar attribute values in dimensions<a class="anchor" aria-label="anchor" href="#detect-similar-attribute-values-in-dimensions"></a>
</h3>
<p>The goal is to find dimension instances whose attribute values differ
in possible different spellings (number of white space, case, use of
punctuation). It does not detect abbreviations.</p>
<p>An initial exploration can be done considering individual attributes
of the dimensions that are indicated or of all the dimensions, if none
are indicated.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_similar_attribute_values_individually.html">get_similar_attribute_values_individually</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $who_segment</span></span>
<span><span class="co">#&gt; list()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $where_chain</span></span>
<span><span class="co">#&gt; list()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $what</span></span>
<span><span class="co">#&gt; $what[[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 1</span></span></span>
<span><span class="co">#&gt;   product </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Diesel  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Diesel +</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $what[[2]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 1</span></span></span>
<span><span class="co">#&gt;   product  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Natural  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Natural +</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $when</span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
<p>Since no dimension has been indicated, all the dimensions have been
considered but the role-playing and role dimensions have been taken into
account to show the results of only one of them.</p>
<p>In a complementary way, we could consider combinations of attributes
within each dimension. If we do not indicate any dimension, the
combination of all the attributes of each of the dimensions is
considered, as shown below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_similar_attribute_values.html">get_similar_attribute_values</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $who_segment</span></span>
<span><span class="co">#&gt; list()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $where_chain</span></span>
<span><span class="co">#&gt; list()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $what</span></span>
<span><span class="co">#&gt; $what[[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 1</span></span></span>
<span><span class="co">#&gt;   product </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Diesel  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Diesel +</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $what[[2]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 1</span></span></span>
<span><span class="co">#&gt;   product  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Natural  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Natural +</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $when</span></span>
<span><span class="co">#&gt; list()</span></span></code></pre></div>
<p>To more clearly show how these functions work, we are going to modify
a value in a test star database and perform the query on a single
dimension.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_test</span> <span class="op">&lt;-</span> <span class="va">db_summary</span></span>
<span><span class="op">(</span><span class="va">value_seg1</span> <span class="op">&lt;-</span> <span class="va">db_test</span><span class="op">$</span><span class="va">dimensions</span><span class="op">$</span><span class="va">where_chain</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "13"</span></span>
<span><span class="op">(</span><span class="va">value_seg2</span> <span class="op">&lt;-</span> <span class="va">db_test</span><span class="op">$</span><span class="va">dimensions</span><span class="op">$</span><span class="va">where_chain</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "130"</span></span>
<span><span class="va">db_test</span><span class="op">$</span><span class="va">dimensions</span><span class="op">$</span><span class="va">where_chain</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">' ,1-.% $1)='</span></span>
<span><span class="va">db_test</span><span class="op">$</span><span class="va">dimensions</span><span class="op">$</span><span class="va">where_chain</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">chain</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">' ,1-.% $1)='</span></span>
<span></span>
<span><span class="va">db_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_similar_attribute_values_individually.html">get_similar_attribute_values_individually</a></span><span class="op">(</span><span class="st">'where_chain'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 1</span></span></span>
<span><span class="co">#&gt;   chain        </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span> ,1-.% $1)=<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">"</span>11<span style="color: #949494;">"</span></span></span>
<span></span>
<span><span class="va">db_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_similar_attribute_values.html">get_similar_attribute_values</a></span><span class="op">(</span><span class="st">'where_chain'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   chain         country segment        </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span> ,1-.% $1)=<span style="color: #949494;">"</span> CZE     Value for money</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">"</span>11<span style="color: #949494;">"</span>          CZE     Value for money</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-unique-values-of-attributes-in-dimensions">Get unique values of attributes in dimensions<a class="anchor" aria-label="anchor" href="#get-unique-values-of-attributes-in-dimensions"></a>
</h3>
<p>If we focus on a dimension, we can query its attributes and get the
unique value formed by combinations of them. We can indicate a set of
attributes and, if we do not indicate any, all dimension attributes are
considered.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_test</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/get_attribute_names.html">get_attribute_names</a></span><span class="op">(</span><span class="st">'where_chain'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "chain"   "country" "segment"</span></span>
<span></span>
<span><span class="va">db_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'where_chain'</span>, attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'country'</span>, <span class="st">'segment'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 2</span></span></span>
<span><span class="co">#&gt;    country segment        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> CZE     Discount       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> CZE     Noname         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> CZE     Other          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> CZE     Premium        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> CZE     Value for money</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> SVK     Discount       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> SVK     Noname         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> SVK     Other          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> SVK     Premium        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> SVK     Value for money</span></span>
<span></span>
<span><span class="va">db_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'where_chain'</span>, attributes <span class="op">=</span> <span class="st">'chain'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 32 × 1</span></span></span>
<span><span class="co">#&gt;    chain        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span> ,1-.% $1)=<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>1<span style="color: #949494;">"</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>11<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>14<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>15<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>19<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>2<span style="color: #949494;">"</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>21<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>219<span style="color: #949494;">"</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>22<span style="color: #949494;">"</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 22 more rows</span></span></span>
<span></span>
<span><span class="va">db_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'where_chain'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 33 × 3</span></span></span>
<span><span class="co">#&gt;    chain         country segment        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span> ,1-.% $1)=<span style="color: #949494;">"</span> CZE     Value for money</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span> ,1-.% $1)=<span style="color: #949494;">"</span> SVK     Premium        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>1<span style="color: #949494;">"</span>           CZE     Premium        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>11<span style="color: #949494;">"</span>          CZE     Value for money</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>14<span style="color: #949494;">"</span>          CZE     Noname         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>15<span style="color: #949494;">"</span>          CZE     Premium        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>19<span style="color: #949494;">"</span>          CZE     Discount       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>2<span style="color: #949494;">"</span>           CZE     Noname         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>21<span style="color: #949494;">"</span>          CZE     Discount       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>219<span style="color: #949494;">"</span>         SVK     Other          </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 23 more rows</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modifying-attribute-instances-in-dimensions">Modifying attribute instances in dimensions<a class="anchor" aria-label="anchor" href="#modifying-attribute-instances-in-dimensions"></a>
</h2>
<p>In this section we are going to show several cases of modification of
attribute values. Surely, the most suitable thing would be to carry out
the necessary modification operations in the data sources (or as close
to them as possible). In any case, we are going to do them here to show
the possibilities of the <code>rolap</code> package.</p>
<div class="section level3">
<h3 id="modification-of-a-single-value-indicating-several-attributes">Modification of a single value indicating several attributes<a class="anchor" aria-label="anchor" href="#modification-of-a-single-value-indicating-several-attributes"></a>
</h3>
<p>First, let’s start by fixing the bug introduced in the test star
database. For all of the above functions, we can define the parameter
<code>col_as_vector</code> that indicates to display the values as a
vector. We will see later that this can be useful to make changes to the
values, since it is the way to indicate them.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span></span>
<span>    <span class="st">'where_chain'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chain'</span>, <span class="st">'country'</span><span class="op">)</span>,</span>
<span>    col_as_vector <span class="op">=</span> <span class="st">"As a vector"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 33 × 3</span></span></span>
<span><span class="co">#&gt;    chain         country `As a vector`          </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span> ,1-.% $1)=<span style="color: #949494;">"</span> CZE     c(' ,1-.% $1)=', 'CZE')</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span> ,1-.% $1)=<span style="color: #949494;">"</span> SVK     c(' ,1-.% $1)=', 'SVK')</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>1<span style="color: #949494;">"</span>           CZE     c('1', 'CZE')          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>11<span style="color: #949494;">"</span>          CZE     c('11', 'CZE')         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>14<span style="color: #949494;">"</span>          CZE     c('14', 'CZE')         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>15<span style="color: #949494;">"</span>          CZE     c('15', 'CZE')         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>19<span style="color: #949494;">"</span>          CZE     c('19', 'CZE')         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>2<span style="color: #949494;">"</span>           CZE     c('2', 'CZE')          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>21<span style="color: #949494;">"</span>          CZE     c('21', 'CZE')         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>219<span style="color: #949494;">"</span>         SVK     c('219', 'SVK')        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 23 more rows</span></span></span></code></pre></div>
<p>Using the following function, we can indicate one or more attributes
and the old and new values for them. If we indicate several attributes,
in each call we can only change a combination of values. In this way we
restore the original values that we had saved, as you can check
below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary2</span> <span class="op">&lt;-</span> <span class="va">db_test</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'where_chain'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chain'</span>, <span class="st">'country'</span><span class="op">)</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">' ,1-.% $1)='</span>, <span class="st">'CZE'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">value_seg1</span>, <span class="st">'CZE'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'where_chain'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chain'</span>, <span class="st">'country'</span><span class="op">)</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">' ,1-.% $1)='</span>, <span class="st">'SVK'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">value_seg2</span>, <span class="st">'SVK'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">db_summary2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span></span>
<span>    <span class="st">'where_chain'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'chain'</span>, <span class="st">'country'</span><span class="op">)</span>,</span>
<span>    col_as_vector <span class="op">=</span> <span class="st">"As a vector"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 33 × 3</span></span></span>
<span><span class="co">#&gt;    chain country `As a vector`  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1     CZE     c('1', 'CZE')  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 11    CZE     c('11', 'CZE') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 13    CZE     c('13', 'CZE') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 130   SVK     c('130', 'SVK')</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 14    CZE     c('14', 'CZE') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 15    CZE     c('15', 'CZE') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 19    CZE     c('19', 'CZE') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2     CZE     c('2', 'CZE')  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 21    CZE     c('21', 'CZE') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 219   SVK     c('219', 'SVK')</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 23 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modifying-multiple-values-of-an-attribute">Modifying multiple values of an attribute<a class="anchor" aria-label="anchor" href="#modifying-multiple-values-of-an-attribute"></a>
</h3>
<p>If we want to modify the values of a single attribute, we can
indicate several values that correspond to a new value.</p>
<p>In this case, we are going to make modifications in two of the
dimensions. First, in dimension <em>what</em>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="va">db_summary2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'what'</span>, col_as_vector <span class="op">=</span> <span class="st">"As a vector"</span><span class="op">)</span></span></code></pre></div>
<p>Suppose that, in view of the available values, we consider that we do
not need details of all those products, but that we need a
simplification: The one shown below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary3</span> <span class="op">&lt;-</span> <span class="va">db_summary2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'what'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'product'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Autokosmet.'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Autokozmetik'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'what'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'product'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Diesel aditiv'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Diesel +'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'what'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'product'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Nafta Plus'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Nafta +'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'what'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'product'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Nat.Super'</span>, <span class="st">'Natural Plus'</span>, <span class="st">'Natural Spec'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Natural +'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'what'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'product'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Autoprísluš.'</span>, <span class="st">'Dalnic.popl.'</span>, <span class="st">'Knihy,nov.'</span>, <span class="st">'LPG'</span>, <span class="st">'Mytí vozidel'</span>,</span>
<span>            <span class="st">'Nemrz.kapal.'</span>, <span class="st">'Obcerstvení'</span>, <span class="st">'Oleje,tuky'</span>, <span class="st">'Potraviny'</span>, <span class="st">'Prev.náplne'</span>,</span>
<span>            <span class="st">'Provoz.nápl.'</span>, <span class="st">'Umývanie voz'</span>, <span class="st">'Zboží nesp.'</span>, <span class="st">'Zpr.nakupu'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Other'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/group_dimension_instances.html">group_dimension_instances</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'what'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in res$name == name: longer object length is not a multiple of shorter</span></span>
<span><span class="co">#&gt; object length</span></span>
<span></span>
<span><span class="co">#&gt; Warning in res$name == name: longer object length is not a multiple of shorter</span></span>
<span><span class="co">#&gt; object length</span></span>
<span></span>
<span><span class="co">#&gt; Warning in res$name == name: longer object length is not a multiple of shorter</span></span>
<span><span class="co">#&gt; object length</span></span></code></pre></div>
<p>We change the name of some products because there seems to be an
error or they were spelled two different ways; in others cases we group
several products into a new one, the largest grouping is for products
that are renamed <em>Other</em>. Finally, if, as a result of the
modifications, we have reduced the number of distinct instances of the
dimension, when we finish making modifications, we must group the
dimension instances to simplify it using the
<code><a href="../reference/group_dimension_instances.html">group_dimension_instances()</a></code> function. As a side result, the
facts may also be grouped.</p>
<p>The result for the dimension can be seen below.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'what'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 1</span></span></span>
<span><span class="co">#&gt;   product     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Additivum   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Autokozmetik</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Diesel      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Diesel +    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Nafta       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Nafta +     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Natural     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> Natural +   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> Other</span></span></code></pre></div>
<p>If we get the number of instances of the tables (as we did at the
beginning of this document) we verify that the number of records in the
fact table has been reduced. We also check that the number of original
records (indicated by measure <code>transactions</code>) from which
these have been obtained is maintained. That is, several fact table
records have been added as a side effect of the dimension changes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_tl</span> <span class="op">&lt;-</span> <span class="va">db_summary3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_tibble_list.html">as_tibble_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">names</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"name: %s, %d rows\n"</span>, <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">db_tl</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; name: transaction_summary, 759 rows</span></span>
<span><span class="co">#&gt; name: what, 9 rows</span></span>
<span><span class="co">#&gt; name: when, 84 rows</span></span>
<span><span class="co">#&gt; name: when_paid, 84 rows</span></span>
<span><span class="co">#&gt; name: where_chain, 33 rows</span></span>
<span><span class="co">#&gt; name: who_segment, 6 rows</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">db_tl</span><span class="op">[[</span><span class="st">'transaction_summary'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">transactions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modification-of-instances-in-role-playing-and-role-dimensions">Modification of instances in role-playing and role dimensions<a class="anchor" aria-label="anchor" href="#modification-of-instances-in-role-playing-and-role-dimensions"></a>
</h3>
<p>The two <em>When</em> dimensions are role-playing and role
dimensions. That is, they have the same instances and one can be
obtained from the other by renaming attributes if necessary and of
course the table.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_role_playing_dimension_names.html">get_role_playing_dimension_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $rpd_1</span></span>
<span><span class="co">#&gt; [1] "when"      "when_paid"</span></span>
<span></span>
<span><span class="va">db_summary3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'when'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 84 × 2</span></span></span>
<span><span class="co">#&gt;    date       hour </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2012-08-23 09   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2012-08-23 20   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2012-08-23 21   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2012-08-23 22   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2012-08-23 23   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2012-08-24 00   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2012-08-24 03   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2012-08-24 04   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2012-08-24 05   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2012-08-24 06   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 74 more rows</span></span></span>
<span></span>
<span><span class="va">db_summary3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'when_paid'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 84 × 2</span></span></span>
<span><span class="co">#&gt;    date       hour </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2012-08-23 09   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2012-08-23 20   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2012-08-23 21   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2012-08-23 22   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2012-08-23 23   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2012-08-24 00   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2012-08-24 03   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2012-08-24 04   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2012-08-24 05   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2012-08-24 06   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 74 more rows</span></span></span></code></pre></div>
<p>Let us suppose that we are not interested in the specific hours of
the operations, but rather the part of the day in which they were
carried out. Therefore, we define the modifications on one of the
dimensions <em>When</em>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary4</span> <span class="op">&lt;-</span> <span class="va">db_summary3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'when'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'hour'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'05'</span>, <span class="st">'06'</span>, <span class="st">'07'</span>, <span class="st">'08'</span>, <span class="st">'09'</span>, <span class="st">'10'</span>, <span class="st">'11'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Morning'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'when'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'hour'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'12'</span>, <span class="st">'13'</span>, <span class="st">'14'</span>, <span class="st">'15'</span>, <span class="st">'16'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Afternoon'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'when'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'hour'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'17'</span>, <span class="st">'18'</span>, <span class="st">'19'</span>, <span class="st">'20'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Evening'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'when'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'hour'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'21'</span>, <span class="st">'22'</span>, <span class="st">'23'</span>, <span class="st">'00'</span>, <span class="st">'01'</span>, <span class="st">'02'</span>, <span class="st">'03'</span>, <span class="st">'04'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Night'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/group_dimension_instances.html">group_dimension_instances</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'when'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in res$name == name: longer object length is not a multiple of shorter</span></span>
<span><span class="co">#&gt; object length</span></span>
<span></span>
<span><span class="co">#&gt; Warning in res$name == name: longer object length is not a multiple of shorter</span></span>
<span><span class="co">#&gt; object length</span></span>
<span></span>
<span><span class="co">#&gt; Warning in res$name == name: longer object length is not a multiple of shorter</span></span>
<span><span class="co">#&gt; object length</span></span></code></pre></div>
<p>The result obtained in both dimensions is shown below. That is, the
modifications have been propagated to the equivalent dimension.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_summary4</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'when'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 2</span></span></span>
<span><span class="co">#&gt;    date       hour     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2012-08-23 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2012-08-23 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2012-08-23 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2012-08-24 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2012-08-24 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2012-08-24 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2012-08-24 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2012-08-25 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2012-08-25 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2012-08-25 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2012-08-25 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 2012-08-26 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2012-08-26 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 2012-08-26 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2012-08-26 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 2012-08-27 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 2012-08-27 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 2012-08-27 Night</span></span>
<span></span>
<span><span class="va">db_summary4</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'when_paid'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 2</span></span></span>
<span><span class="co">#&gt;    date       hour     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2012-08-23 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2012-08-23 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2012-08-23 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2012-08-24 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2012-08-24 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2012-08-24 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2012-08-24 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2012-08-25 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2012-08-25 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2012-08-25 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2012-08-25 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 2012-08-26 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2012-08-26 Evening  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 2012-08-26 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2012-08-26 Night    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 2012-08-27 Afternoon</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 2012-08-27 Morning  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 2012-08-27 Night</span></span></code></pre></div>
<p>We do the same check as before on the number of instances of the
tables and we observe that in this case the number of records in the
fact table has also been reduced as a result of the aggregation carried
out.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_tl</span> <span class="op">&lt;-</span> <span class="va">db_summary4</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_tibble_list.html">as_tibble_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">names</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"name: %s, %d rows\n"</span>, <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">db_tl</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; name: transaction_summary, 486 rows</span></span>
<span><span class="co">#&gt; name: what, 9 rows</span></span>
<span><span class="co">#&gt; name: when, 18 rows</span></span>
<span><span class="co">#&gt; name: when_paid, 18 rows</span></span>
<span><span class="co">#&gt; name: where_chain, 33 rows</span></span>
<span><span class="co">#&gt; name: who_segment, 6 rows</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">db_tl</span><span class="op">[[</span><span class="st">'transaction_summary'</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">transactions</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modifications-of-instances-in-a-constellation">Modifications of instances in a constellation<a class="anchor" aria-label="anchor" href="#modifications-of-instances-in-a-constellation"></a>
</h2>
<p>To define a constellation we need at least two star databases. We
consider the other star database from the starting example. We look at
the instances of the <em>what</em> dimension.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_finest</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'what'</span>, col_as_vector <span class="op">=</span> <span class="st">"As a vector"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 × 2</span></span></span>
<span><span class="co">#&gt;    product       `As a vector`     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Additivum     c('Additivum')    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Autokosmet.   c('Autokosmet.')  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Autokozmetik  c('Autokozmetik') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Autoprísluš.  c('Autoprísluš.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Dalnic.popl.  c('Dalnic.popl.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Diesel        c('Diesel')       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Diesel +      c('Diesel +')     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Diesel aditiv c('Diesel aditiv')</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Knihy,nov.    c('Knihy,nov.')   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LPG           c('LPG')          </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 17 more rows</span></span></span></code></pre></div>
<p>Suppose some instances of this dimension are also modified, as shown
below.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_finest2</span> <span class="op">&lt;-</span> <span class="va">db_finest</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'what'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'product'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Additivum'</span>, <span class="st">'Autokozmetik'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Other'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/group_dimension_instances.html">group_dimension_instances</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'what'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_finest2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'what'</span>, col_as_vector <span class="op">=</span> <span class="st">"As a vector"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 26 × 2</span></span></span>
<span><span class="co">#&gt;    product       `As a vector`     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Autokosmet.   c('Autokosmet.')  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Autoprísluš.  c('Autoprísluš.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Dalnic.popl.  c('Dalnic.popl.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Diesel        c('Diesel')       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Diesel +      c('Diesel +')     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Diesel aditiv c('Diesel aditiv')</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Knihy,nov.    c('Knihy,nov.')   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> LPG           c('LPG')          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Mytí vozidel  c('Mytí vozidel') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Nafta         c('Nafta')        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more rows</span></span></span></code></pre></div>
<p>We define the constellation and as a result the dimensions are
integrated.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/constellation.html">constellation</a></span><span class="op">(</span><span class="st">"CSS"</span>, <span class="va">db_summary4</span>, <span class="va">db_finest2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">ct</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "star_database"</span></span>
<span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_table_names.html">get_table_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_tl</span> <span class="op">&lt;-</span> <span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_tibble_list.html">as_tibble_list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">names</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"name: %s, %d rows\n"</span>, <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">db_tl</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; name: transaction, 921 rows</span></span>
<span><span class="co">#&gt; name: transaction_line, 1000 rows</span></span>
<span><span class="co">#&gt; name: transaction_summary, 486 rows</span></span>
<span><span class="co">#&gt; name: what, 29 rows</span></span>
<span><span class="co">#&gt; name: when, 124 rows</span></span>
<span><span class="co">#&gt; name: when_moment, 599 rows</span></span>
<span><span class="co">#&gt; name: when_paid, 124 rows</span></span>
<span><span class="co">#&gt; name: when_processed, 124 rows</span></span>
<span><span class="co">#&gt; name: where, 437 rows</span></span>
<span><span class="co">#&gt; name: where_chain, 33 rows</span></span>
<span><span class="co">#&gt; name: who, 902 rows</span></span>
<span><span class="co">#&gt; name: who_segment, 6 rows</span></span></code></pre></div>
<div class="section level3">
<h3 id="transformations-in-just-one-star-database">Transformations in just one star database<a class="anchor" aria-label="anchor" href="#transformations-in-just-one-star-database"></a>
</h3>
<p>For the dimension <em>When</em>, transformations were defined in only
one of the star databases. The role-playing and role dimensions of the
two star databases are also integrated. As a result, modifications are
carried over from one star database to the other.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_role_playing_dimension_names.html">get_role_playing_dimension_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $rpd_1</span></span>
<span><span class="co">#&gt; [1] "when"           "when_paid"      "when_processed"</span></span>
<span></span>
<span><span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'when_processed'</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 124 × 2</span></span></span>
<span><span class="co">#&gt;    date       hour   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2012-08-23 09     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2012-08-23 20     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2012-08-23 21     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2012-08-23 22     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2012-08-23 23     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2012-08-23 Evening</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2012-08-23 Morning</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2012-08-23 Night  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2012-08-24 00     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2012-08-24 03     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 114 more rows</span></span></span></code></pre></div>
<p>The result is shown for dimension <em>when_processed</em>, which is
not part of the star database on which the modifications were defined
but it is modified.</p>
</div>
<div class="section level3">
<h3 id="transformations-in-both-star-databases">Transformations in both star databases<a class="anchor" aria-label="anchor" href="#transformations-in-both-star-databases"></a>
</h3>
<p>In the case of the <em>what</em> dimension, transformations have been
carried out in both star databases: They are combined taking the new
operations from one database to another.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'what'</span>, col_as_vector <span class="op">=</span> <span class="st">"As a vector"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 29 × 2</span></span></span>
<span><span class="co">#&gt;    product       `As a vector`     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Additivum     c('Additivum')    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Autokosmet.   c('Autokosmet.')  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Autokozmetik  c('Autokozmetik') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Autoprísluš.  c('Autoprísluš.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Dalnic.popl.  c('Dalnic.popl.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Diesel        c('Diesel')       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Diesel +      c('Diesel +')     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Diesel aditiv c('Diesel aditiv')</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Knihy,nov.    c('Knihy,nov.')   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> LPG           c('LPG')          </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 19 more rows</span></span></span></code></pre></div>
<p>The result obtained is explained because in star database
<em>db_summary</em> the new operations of star database
<em>db_finest</em> have been applied and vice versa. In the star
database <em>db_finest</em>, the <em>Autokosmet.</em> to
<em>Autokozmetik</em> transformation has been applied after the
<em>Autokozmetik</em> to <em>Other</em> transformation, so the
<em>Autokozmetik</em> value has been generated.</p>
<p>This situation has been sought in this example. When defining a
constellation we must review the resulting dimensions. In any case, we
can continue to make changes to the constellation, as shown below.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ct2</span> <span class="op">&lt;-</span> <span class="va">ct</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/replace_attribute_values.html">replace_attribute_values</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">'what'</span>,</span>
<span>    attributes <span class="op">=</span> <span class="st">'product'</span>,</span>
<span>    old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Autokozmetik'</span><span class="op">)</span>,</span>
<span>    new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Other'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/group_dimension_instances.html">group_dimension_instances</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'what'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in res$name == name: longer object length is not a multiple of shorter</span></span>
<span><span class="co">#&gt; object length</span></span>
<span></span>
<span><span class="va">ct2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_unique_attribute_values.html">get_unique_attribute_values</a></span><span class="op">(</span><span class="st">'what'</span>, col_as_vector <span class="op">=</span> <span class="st">"As a vector"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 28 × 2</span></span></span>
<span><span class="co">#&gt;    product       `As a vector`     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Additivum     c('Additivum')    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Autokosmet.   c('Autokosmet.')  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Autoprísluš.  c('Autoprísluš.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Dalnic.popl.  c('Dalnic.popl.') </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Diesel        c('Diesel')       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Diesel +      c('Diesel +')     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Diesel aditiv c('Diesel aditiv')</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Knihy,nov.    c('Knihy,nov.')   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> LPG           c('LPG')          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Mytí vozidel  c('Mytí vozidel') </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 18 more rows</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>This document shows how to perform modification operations on
dimension instances in both star databases and constellations. The
modifications take into account the definition of role-playing and role
dimensions both in a single database and in the integration of several
to form a constellation.</p>
<p>In the case of performing operations on common dimensions of several
star databases, the new operations are carried from one to another star
database. If there is a conflict, we may need to define new operations
on the constellation.</p>
<p>Although it is usually advisable to carry out the modification
operations as close as possible to the data sources, this mechanism
gives us flexibility especially when integrating several star databases
into a constellation.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jose Samos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
